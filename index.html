<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>E</title>
    <script src="js/lib/jquery-2.1.1.js"></script>
    <script src="js/lib/E.js"></script>
    <script src="js/lib/util.js"></script>
</head>

<body>
    <ul>
        <li class="J_spu-property" id="spu_122216586" name="spus">
            <label class="label-title">服装版型：</label>
            <span>
<ul class="J_ul-single ul-select"><li>
<select name="cp_122216586" id="prop_122216586" data-transtype="dropbox">
<option value=""> </option>
<option value="122216586:29947">直筒</option>
<option value="122216586:130137">修身</option>
<option value="122216586:27295811">高腰型</option>
</select>
</li></ul>
</span>
            <input type="hidden" id="nav_cp_122216586" data-feed="err_NotNull_122216586" />
            <div id="err_NotNull_122216586" style="display:none;"></div>
        </li>
        <li class="J_spu-property" id="spu_20608" name="spus">
            <label class="label-title">风格：</label>
            <span>
<ul class="J_ul-single ul-select"><li>
<select name="cp_20608" id="prop_20608" data-transtype="dropbox">
<option value=""> </option>
<option value="20608:3223746">原创设计</option>
<option value="20608:29921">百搭</option>
<option class="J_father" value="20608:3267776">甜美</option>
<option value="20608:20213">其他</option>
<option class="J_father" value="20608:29934">街头</option>
<option class="J_father" value="20608:6384766">通勤</option>
</select>
</li></ul>
</span>
            <input type="hidden" id="nav_cp_20608" data-feed="err_NotNull_20608" />
            <div id="err_NotNull_20608" style="display:none;"></div>
        </li>
        <li class="J_spu-property" id="spu_122216562" name="spus">
            <label class="label-title">衣长：</label>
            <span>
<ul class="J_ul-single ul-select"><li>
<select name="cp_122216562" id="prop_122216562" data-transtype="dropbox">
<option value=""> </option>
<option value="122216562:3226292">常规款</option>
<option value="122216562:22561361">超短款</option>
<option value="122216562:47502">&#30701;&#27454;(40cm&lt;&#34915;&#38271;&le;50cm)</option>
<option value="122216562:44597">中长款</option>
</select>
</li></ul>
</span>
            <input type="hidden" id="nav_cp_122216562" data-feed="err_NotNull_122216562" />
            <div id="err_NotNull_122216562" style="display:none;"></div>
        </li>
        <li class="J_spu-property" id="spu_122216348" name="spus">
            <label class="label-title">袖长：</label>
            <span>
<ul class="J_ul-single ul-select"><li>
<select name="cp_122216348" id="prop_122216348" data-transtype="dropbox">
<option value=""> </option>
<option value="122216348:29445">短袖</option>
<option value="122216348:29444">长袖</option>
<option value="122216348:11162412">九分袖</option>
<option value="122216348:3216779">七分袖</option>
<option value="122216348:14587965">五分袖</option>
<option value="122216348:29446">无袖</option>
</select>
</li></ul>
</span>
            <input type="hidden" id="nav_cp_122216348" data-feed="err_NotNull_122216348" />
            <div id="err_NotNull_122216348" style="display:none;"></div>
        </li>
    </ul>
    <select id="select">
        <option value="0">请选择</option>
        <option value="1">前端</option>
        <option value="2">java</option>
        <option value="20000:940292445">A BAO MYTHOLOGY</option>
        <option value="20000:96440817">A NOBLE HALL/絮澜雅</option>
        <option value="20000:227266075">A-MIN</option>
        <option value="20000:115433">A.D</option>
        <option value="20000:132438">A.G.S.D</option>
        <option value="20000:3286334">A205</option>
        <option value="20000:3260856">A21</option>
        <option value="20000:38545">A5</option>
        <option value="20000:6102373">ABA</option>
        <option value="20000:3710084">ABAHOUSE</option>
        <option value="20000:910966805">ABBOZZO</option>
        <option value="20000:43434205">ABLE JEANS</option>
    </select>
    <script type="text/javascript">
    <!--
    var select = document.getElementById("select");
    var $select = $(select);
    $select.change(function(e) {
        console.info('jquery change', e);
    });
    select.onchange = function(e) {
        console.info('jquery onchange', e);
    };
    // $select.children('[value="1"]:first').attr('selected', 'selected');
    // $select.val('20000:43434205');
    // E.dispatch(select, "change");
    E.dispatch(window, "test");
    setTimeout(function() {
        $(document.body).append('<select><option value="13328588:492838735">91%(含)-95%(含)</option></select>');
    }, 3 * 1000);

    var property = {
        "success": true,
        "model": {
            "list": [{
                "k": "主要参数",
                "v": [{
                    "k": "廓形",
                    "v": "A型"
                }, {
                    "k": "材质成分",
                    "v": "聚酯纤维100%"
                }, {
                    "k": "销售渠道类型",
                    "v": "纯电商(只在线上销售)"
                }, {
                    "k": "货号",
                    "v": "MY4676"
                }, {
                    "k": "风格",
                    "v": "通勤"
                }, {
                    "k": "通勤",
                    "v": "韩版"
                }, {
                    "k": "组合形式",
                    "v": "单件"
                }, {
                    "k": "裙长",
                    "v": "短裙"
                }, {
                    "k": "款式",
                    "v": "其他/other"
                }, {
                    "k": "袖长",
                    "v": "长袖"
                }, {
                    "k": "领型",
                    "v": "立领"
                }, {
                    "k": "袖型",
                    "v": "常规"
                }, {
                    "k": "腰型",
                    "v": "宽松腰"
                }, {
                    "k": "衣门襟",
                    "v": "套头"
                }, {
                    "k": "裙型",
                    "v": "A字裙"
                }, {
                    "k": "图案",
                    "v": "纯色"
                }, {
                    "k": "流行元素/工艺",
                    "v": "褶皱镂空纽扣拼接抽褶"
                }, {
                    "k": "品牌",
                    "v": "HSTYLE/韩都衣舍"
                }, {
                    "k": "面料",
                    "v": "其他"
                }, {
                    "k": "成分含量",
                    "v": "95%以上"
                }, {
                    "k": "材质",
                    "v": "涤纶"
                }, {
                    "k": "适用年龄",
                    "v": "25-29周岁"
                }, {
                    "k": "年份季节",
                    "v": "2015年秋季"
                }, {
                    "k": "颜色分类",
                    "v": "灰色炭黑色"
                }, {
                    "k": "尺码",
                    "v": "SML"
                }]
            }]
        }
    };

    var label_map = {};

    $('.label-title').each(function(i, label) {
        var key = label.innerText.replace('：', '');
        label_map[key] = $(label).closest('li');
    });
    util.each(property.model.list, function(i, item) {
        util.each(item.v, function(n, pro) {
            var $li = label_map[pro.k];
            if ($li) {
                util.each($li.find('option'), function(m, option) {
                    if (selectedOption(option, pro.v)) {
                        delete label_map[pro.k];
                        return false;
                    }
                });
            }
        });
    });

    function selectedOption(option, text) {
        if (option.innerText == text) {
            option.selected = true;
            E.dispatch(option.parentElement, "change");
            return true;
        }
    };
    //-->
    </script>
</body>

</html>
